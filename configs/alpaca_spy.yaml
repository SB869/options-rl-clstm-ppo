seed: 123

data:
  provider: alpaca
  symbols: [SPY]                # underlyings
  start: "2024-08-01"           # inclusive (UTC)
  end:   "2024-11-01"           # exclusive (UTC)
  timeframe: "1Min"             # Alpaca bars timeframe
  dte_min: 7
  dte_max: 30
  strikes_around: 5             # ATM ±N strikes
  cache_dir: "data/alpaca"      # Parquet cache root
  backfill: true                # enable first run to pull + cache
  fetch_iv: false               # Alpaca greeks coverage varies; keep false initially
  batch_size: 100               # symbols per bars request
  rate_limit_sleep: 0.5         # seconds between API calls

  # Helpful defaults for Alpaca options when used by other parts of your pipeline
  feed: "opra"                  # OPRA = options tape
  rth_only: true                # fetch during regular trading hours
  timezone: "America/New_York"  # session calendar tz

env:
  option:
    kind: call
    dte_start: 14
  costs:
    commission_per_contract: 0.65
    spread_bps: 15
    scale: 1e-4
  turbulence:
    window: 60
    pct: 0.9
    enabled: true
  max_positions: 20

trainer:
  episodes: 50
  gamma: 0.99
  gae_lambda: 0.95
  clip_eps: 0.2
  value_coef: 0.5
  entropy_coef: 0.01
  lr: 3.0e-4
  batch_steps: 2048
  epochs: 10
  minibatch_size: 256
  value_clip: 0.2
  target_kl: 0.03
  device: "cuda"
  amp_dtype: "bfloat16"

# Backfill block used by apps/backfill_alpaca.py
backfill:
  underlying: "SPY"
  start_date: "2024-08-01"
  end_date: "2024-11-01"
  outdir: "data/alpaca/SPY"

  # Data resolution & feed
  timeframe: "1Min"
  feed: "opra"                  # critical for options bars

  # Chain filters (mirrors data.* settings but uses moneyness, which is more robust)
  atm_moneyness_pct: 0.25       # keep strikes within ±15% of spot0
  min_dte: 3                    # mirrors data.dte_min
  max_dte: 45                   # mirrors data.dte_max

  # Sessions
  rth_only: true
  timezone: "America/New_York"

  # Outputs
  write_chain: true
  write_underlying: true
